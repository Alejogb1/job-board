---
title: "How can I create subscripts for labels in ggarrange in R?"
date: "2025-01-30"
id: "how-can-i-create-subscripts-for-labels-in"
---
Subscripting text within `ggarrange` label annotations, while not directly supported by a dedicated parameter, can be achieved through the combination of `expression()` and Unicode characters within the `labels` argument of the `ggarrange` function in the `ggpubr` package. This approach leverages R's capacity to interpret mathematical expressions and specialized characters to construct visually appropriate subscripts for panel labels. My experience in scientific visualization, particularly within ecological studies, frequently involves presenting multi-panel figures where precise notation, such as chemical formula subscripts or species names with taxonomic identifiers, are essential for clarity. Directly embedding these within automatically generated labels requires this combination of expression parsing and specific character coding.

The `ggarrange` function from the `ggpubr` package primarily deals with arranging plots generated by the `ggplot2` package. It does not directly offer a straightforward parameter for subscripting label text. Instead, it expects text strings or expressions to populate the labels of the arranged plots. Therefore, to incorporate subscripts, one must utilize the `expression()` function, which allows for typesetting mathematical notation, and Unicode escape sequences or characters that represent digits as subscripts.

`expression()` interprets a particular type of character string that is rendered as mathematical notation in R's graphics system. Within this context, `[ ]` brackets used in combination with underscore `_` specify subscripted elements. For instance, the expression `expression(paste("X", Y[a]))` will render the character “X” followed by “Y” with “a” as its subscript. However, using actual digits directly with this syntax within `ggarrange` labels can be cumbersome as it requires more intricate nested `paste()` and `symbol()` operations. An alternative, and arguably more readable, method is to use Unicode subscript characters, which exist for digits 0-9. These can be directly embedded within character strings used inside the `expression()` call. For example, `"\u2080"` represents subscript zero, `"\u2081"` represents subscript one, and so on.

This combination offers a flexible and efficient manner to add subscripted numerals to `ggarrange` panel labels. Furthermore, it’s essential to note that `ggarrange` expects a list of labels, corresponding to the number of plots being arranged. This list must contain expressions as the specified elements to properly render the subscripted labels. Failure to format the label strings correctly or to provide enough labels relative to the number of plots will lead to inaccurate or incomplete results.

The following code examples demonstrate how this methodology can be applied in different scenarios.

**Example 1: Simple Subscripted Numbers**

```R
library(ggplot2)
library(ggpubr)

# Generate some sample plots
plot1 <- ggplot(data = data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_line()
plot2 <- ggplot(data = data.frame(x=1:5, y=runif(5)), aes(x,y)) + geom_point()
plot3 <- ggplot(data = data.frame(x=1:5, y=rnorm(5, mean=2)), aes(x,y)) + geom_bar(stat = "identity")

# Create plot labels with subscripts
plot_labels <- list(
  expression(paste("Panel A"[1])),
  expression(paste("Panel B"[2])),
  expression(paste("Panel C"[3]))
)

# Arrange the plots using ggarrange
combined_plot <- ggarrange(plot1, plot2, plot3, 
                           labels = plot_labels)

print(combined_plot)
```

In this first example, I generate three simple plots using `ggplot2`. I then create a list called `plot_labels`. This list contains three `expression()` objects. Each expression is created using `paste` to combine the base text, such as "Panel A", with a bracketed numeric subscript directly created using `[1]`, `[2]` and `[3]`, respectively. These expressions are then passed to the `labels` argument of `ggarrange` to annotate each panel with the corresponding label. This is the most direct approach for adding simple integer based subscripts.

**Example 2: Subscripts using Unicode Characters**

```R
library(ggplot2)
library(ggpubr)

# Generate some sample plots
plot1 <- ggplot(data = data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_line()
plot2 <- ggplot(data = data.frame(x=1:5, y=runif(5)), aes(x,y)) + geom_point()

# Unicode subscripted labels
plot_labels_unicode <- list(
  expression(paste("Experiment ", A,"\u2081")),
  expression(paste("Experiment ", B,"\u2082"))
)

# Arrange the plots with unicode subscripts
combined_plot_unicode <- ggarrange(plot1, plot2,
                                   labels = plot_labels_unicode)

print(combined_plot_unicode)
```

Here, the approach differs in the construction of the label strings. Instead of using `[]` bracket syntax,  Unicode subscript characters are directly embedded into the character string. `\u2081` represents the subscript "1", and `\u2082` represents the subscript "2". The `paste` function again combines the base text, such as "Experiment A", with the Unicode subscript.  This method results in more compact and visually clear subscript annotations, particularly when dealing with more complicated subscripts which may require intermediate symbols.

**Example 3: Combining Unicode and Other Expression Elements**

```R
library(ggplot2)
library(ggpubr)

# Sample plots
plot1 <- ggplot(data = data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_line()
plot2 <- ggplot(data = data.frame(x=1:5, y=runif(5)), aes(x,y)) + geom_point()

# Combined label elements
plot_labels_combined <- list(
    expression(paste("Data ", x[i]," (", "\u2080" , ")")),
    expression(paste("Data ", y[i]," (", "\u2081" , ")"))
)


# Arrange the plots with combined elements
combined_plot_combined <- ggarrange(plot1, plot2, 
                                    labels = plot_labels_combined)

print(combined_plot_combined)
```

In this example, I demonstrate how `expression()` allows for a combination of conventional mathematical notation (like the subscripted ‘i’ represented by `x[i]` or `y[i]`) alongside Unicode characters used to represent a zero and a one. It also shows how to embed special characters like parenthesis, which will be rendered according to the `expression` syntax. This showcases the capability to craft complex expressions with subscripted variables, characters and additional formatting with the same unified approach. This level of control is crucial when precision and clarity of notation within a multi-panel figure are essential.

**Resource Recommendations**

To further expand on the nuances of `expression()` syntax, consult the official R documentation related to plotting and text formatting. For a more comprehensive overview of using `expression` consider exploring tutorials on mathematical expressions in R, which often cover a range of symbols and typesetting capabilities. Specific examples of using Unicode characters can often be found within online repositories related to character encodings or data manipulation. Although outside the R context, familiarity with character encodings can be helpful for managing special characters in labels and titles. Additionally, examining the source code of the `ggpubr` package will provide insights into how it manages plot arrangement and label interpretation. Understanding these foundational concepts is critical when complex, formatted labels are desired in multi-panel figures.
